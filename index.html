<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workplace Personality Assessment</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.js"></script>
    <style>
        /* Custom animations */
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .slide-up {
            animation: slideUp 0.2s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(5px); opacity: 0.8; }
            to { transform: translateY(0); opacity: 1; }
        }
        .progress-bar {
            transition: width 0.3s ease-in-out;
        }
        .score-bar {
            transition: width 1s ease-in-out;
        }
        
        /* Ensure Tailwind classes work */
        .bg-gradient-to-br { background-image: linear-gradient(to bottom right, var(--tw-gradient-stops)); }
        .from-indigo-50 { --tw-gradient-from: #eef2ff; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(238, 242, 255, 0)); }
        .via-white { --tw-gradient-stops: var(--tw-gradient-from), #ffffff, var(--tw-gradient-to, rgba(255, 255, 255, 0)); }
        .to-cyan-50 { --tw-gradient-to: #ecfeff; }
        
        /* Force key gradient colors */
        .bg-gradient-to-r.from-indigo-600.to-purple-600 {
            background: linear-gradient(to right, #4f46e5, #9333ea) !important;
        }
        .bg-gradient-to-r.from-green-600.to-green-700 {
            background: linear-gradient(to right, #16a34a, #15803d) !important;
        }
        .bg-gradient-to-r.from-green-500.to-green-600 {
            background: linear-gradient(to right, #22c55e, #16a34a) !important;
        }
        .bg-gradient-to-r.from-gray-500.to-gray-600 {
            background: linear-gradient(to right, #6b7280, #4b5563) !important;
        }
        .bg-gradient-to-r.from-red-500.to-red-600 {
            background: linear-gradient(to right, #ef4444, #dc2626) !important;
        }
        .bg-gradient-to-r.from-red-600.to-red-700 {
            background: linear-gradient(to right, #dc2626, #b91c1c) !important;
        }
        .bg-gradient-to-r.from-green-500.to-teal-600 {
            background: linear-gradient(to right, #22c55e, #0d9488) !important;
        }
        
        /* Trait color backgrounds */
        .bg-blue-500 { background-color: #3b82f6 !important; }
        .bg-pink-500 { background-color: #ec4899 !important; }
        .bg-green-500 { background-color: #22c55e !important; }
        .bg-purple-500 { background-color: #a855f7 !important; }
        .bg-yellow-500 { background-color: #eab308 !important; }
        .bg-red-500 { background-color: #ef4444 !important; }
        .bg-indigo-500 { background-color: #6366f1 !important; }
        .bg-orange-500 { background-color: #f97316 !important; }
        .bg-teal-500 { background-color: #14b8a6 !important; }
        .bg-cyan-500 { background-color: #06b6d4 !important; }

        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 280px;
            background-color: #1f2937;
            color: #fff;
            text-align: left;
            border-radius: 8px;
            padding: 12px;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -140px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
            line-height: 1.4;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #1f2937 transparent transparent transparent;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        @media (max-width: 640px) {
            .tooltip .tooltiptext {
                width: 250px;
                margin-left: -125px;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-cyan-50">
    <div id="app" class="p-4"></div>

    <script>
        // Assessment data
        const behaviorData = [
            {
                trait: "Patience",
                icon: "brain",
                color: "bg-blue-500",
                behaviors: [
                    { statement: "I tend to tailgate when driving.", direction: -1 },
                    { statement: "I leave at least 2 seconds of distance between me and the car in front.", direction: 1 },
                    { statement: "I interrupt others before they finish speaking.", direction: -1 }
                ]
            },
            {
                trait: "Self-Maintenance",
                icon: "heart",
                color: "bg-pink-500",
                behaviors: [
                    { statement: "I often skip breakfast or lunch without realizing it.", direction: -1 },
                    { statement: "I make time to eat even on busy days.", direction: 1 },
                    { statement: "I routinely sacrifice sleep for work tasks.", direction: -1 }
                ]
            },
            {
                trait: "Focus",
                icon: "target",
                color: "bg-green-500",
                behaviors: [
                    { statement: "I check every notification as soon as it appears.", direction: -1 },
                    { statement: "I can go hours without checking my phone when deep in work.", direction: 1 },
                    { statement: "I leave tabs open until I forget why I opened them.", direction: -1 }
                ]
            },
            {
                trait: "Control Orientation",
                icon: "settings",
                color: "bg-purple-500",
                behaviors: [
                    { statement: "I organize my space obsessively before I can begin work.", direction: 1 },
                    { statement: "I dislike using calendars or to-do apps.", direction: -1 },
                    { statement: "I feel uneasy when plans change suddenly.", direction: 1 }
                ]
            },
            {
                trait: "Risk Tolerance",
                icon: "zap",
                color: "bg-yellow-500",
                behaviors: [
                    { statement: "I enjoy being the first one to try something new, even if it's untested.", direction: 1 },
                    { statement: "I prefer to wait until others test something before I jump in.", direction: -1 },
                    { statement: "I feel uncomfortable making decisions without complete data.", direction: -1 }
                ]
            },
            {
                trait: "Empathy",
                icon: "heart",
                color: "bg-red-500",
                behaviors: [
                    { statement: "I treat animals as if they understand me.", direction: 1 },
                    { statement: "I notice when people feel uncomfortable, even if they don't say it.", direction: 1 },
                    { statement: "I tend to overlook others' feelings when focused on a task.", direction: -1 }
                ]
            },
            {
                trait: "Structure Preference",
                icon: "shield",
                color: "bg-indigo-500",
                behaviors: [
                    { statement: "I pack excessively for even short trips.", direction: 1 },
                    { statement: "I rarely plan ahead and often wing it.", direction: -1 },
                    { statement: "I double-check everything before leaving the house.", direction: 1 }
                ]
            },
            {
                trait: "Social Energy",
                icon: "users",
                color: "bg-orange-500",
                behaviors: [
                    { statement: "I'm the first one on the dance floor at events.", direction: 1 },
                    { statement: "I avoid social situations unless necessary.", direction: -1 },
                    { statement: "I feel energized after interacting with strangers.", direction: 1 }
                ]
            },
            {
                trait: "Initiative",
                icon: "star",
                color: "bg-teal-500",
                behaviors: [
                    { statement: "I start tasks right away without needing reminders.", direction: 1 },
                    { statement: "I wait until deadlines are near to begin working.", direction: -1 },
                    { statement: "I need external pressure to finish personal projects.", direction: -1 }
                ]
            },
            {
                trait: "Stress Regulation",
                icon: "check-circle",
                color: "bg-cyan-500",
                behaviors: [
                    { statement: "I lose my temper in traffic or long lines.", direction: -1 },
                    { statement: "I recover quickly from setbacks or delays.", direction: 1 },
                    { statement: "I carry emotional stress from one part of my life into another.", direction: -1 }
                ]
            }
        ];
        
        // Add this object before your existing JavaScript code
        const traitDefinitions = {
            "Patience": "Your ability to remain calm and composed when facing delays, interruptions, or challenging situations. High patience indicates comfort with waiting and giving others time to complete tasks, while low patience suggests a preference for immediate action and quick resolution.",
            
            "Self-Maintenance": "How well you prioritize and maintain your personal wellbeing through basic needs like nutrition, sleep, and self-care. High self-maintenance reflects sustainable work habits and attention to physical health, while low scores indicate tendency to sacrifice personal needs for work demands.",
            
            "Focus": "Your capacity to maintain deep concentration and resist distractions when working on important tasks. High focus means you can work for extended periods without interruption, while low focus suggests susceptibility to notifications, multitasking, and attention fragmentation.",
            
            "Control Orientation": "Your preference for structure, planning, and having systems in place before beginning work or making decisions. High control orientation indicates comfort with detailed planning and organized environments, while low scores suggest flexibility with ambiguity and spontaneous approaches.",
            
            "Risk Tolerance": "Your comfort level with uncertainty, experimentation, and trying new approaches without complete information or guarantees. High risk tolerance means embracing unknown outcomes and being first to try innovations, while low tolerance prefers proven methods and comprehensive data.",
            
            "Empathy": "Your ability to recognize, understand, and respond appropriately to the emotions and perspectives of others around you. High empathy indicates strong social awareness and consideration for others' feelings, while low empathy suggests task-focused approaches that may overlook interpersonal dynamics.",
            
            "Structure Preference": "Your preference for organized, predictable environments versus flexible, adaptable situations that change frequently. High structure preference means thriving with clear processes and advance preparation, while low scores indicate comfort with improvisation and dynamic conditions.",
            
            "Social Energy": "How much energy you gain or lose from interpersonal interactions and collaborative activities with colleagues or strangers. High social energy means feeling energized by team meetings and networking, while low social energy suggests preference for independent work and smaller group interactions.",
            
            "Initiative": "Your tendency to begin tasks proactively without external prompts, deadlines, or management oversight to drive action. High initiative indicates self-starting behavior and proactive problem-solving, while low initiative suggests responsiveness to external structure and guidance from others.",
            
            "Stress Regulation": "Your ability to maintain emotional equilibrium and recover quickly when facing pressure, setbacks, or unexpected challenges. High stress regulation means staying calm under pressure and bouncing back from difficulties, while low regulation indicates susceptibility to emotional overwhelm and longer recovery periods."
        };

        const personalityProfiles = [
            {
                name: "Strategic Innovator",
                description: "Thrives in forward-thinking environments with autonomy and creative challenges",
                workplaceStyle: "Leads change initiatives and embraces uncertainty as opportunity. Prefers minimal oversight and maximum creative freedom. Often the first to propose unconventional solutions and push boundaries. Works best when given big-picture goals rather than detailed instructions.",
                growthEdge: "May move too quickly from idea to idea without fully developing implementation details. Can become impatient with slower-moving colleagues or extensive approval processes.",
                match: (scores) => scores["Risk Tolerance"] > 70 && scores["Initiative"] > 60 && scores["Focus"] > 60,
                score: (scores) => (scores["Risk Tolerance"] + scores["Initiative"] + scores["Focus"]) / 3
            },
            {
                name: "Collaborative Harmonizer", 
                description: "Excels in team-oriented cultures with strong interpersonal dynamics",
                workplaceStyle: "Natural mediator who builds bridges between different personalities and departments. Thrives in consensus-driven environments and excels at reading team dynamics. Often becomes the informal team counselor and culture carrier. Prefers collaborative decision-making over individual mandates.",
                growthEdge: "May avoid necessary conflicts or difficult conversations to maintain harmony. Sometimes struggles to advocate for their own ideas when they differ from group consensus.",
                match: (scores) => scores["Empathy"] > 70 && scores["Social Energy"] > 60 && scores["Patience"] > 60,
                score: (scores) => (scores["Empathy"] + scores["Social Energy"] + scores["Patience"]) / 3
            },
            {
                name: "Operational Excellence",
                description: "Perfect for structured environments requiring attention to detail and consistency",
                workplaceStyle: "The backbone of reliable execution. Creates and maintains systems that others depend on. Thrives on clear processes and measurable outcomes. Often becomes the go-to person for complex logistics and quality assurance. Values predictability and systematic approaches to problem-solving.",
                growthEdge: "Can become overwhelmed when priorities shift rapidly or when forced to work without clear guidelines. May resist changes to established processes even when improvement is needed.",
                match: (scores) => scores["Structure vs Chaos"] > 70 && scores["Control Orientation"] > 60 && scores["Focus"] > 60,
                score: (scores) => (scores["Structure vs Chaos"] + scores["Control Orientation"] + scores["Focus"]) / 3
            },
            {
                name: "Resilient Adapter",
                description: "Fits well in dynamic, fast-paced environments with changing priorities",
                workplaceStyle: "The steady hand during turbulent times. Maintains composure when plans shift and deadlines compress. Often assigned to crisis management or high-pressure projects. Excels at juggling multiple priorities without losing focus. Teammates rely on them to stay calm and solution-focused when others feel overwhelmed.",
                growthEdge: "May take on too many responsibilities without asking for help, leading to eventual burnout. Sometimes appears emotionally distant when focusing intensely on problem-solving.",
                match: (scores) => scores["Stress Regulation"] > 70 && scores["Risk Tolerance"] > 50 && scores["Initiative"] > 60,
                score: (scores) => (scores["Stress Regulation"] + scores["Risk Tolerance"] + scores["Initiative"]) / 3
            },
            {
                name: "Thoughtful Analyst",
                description: "Suited for research-oriented or analytical roles requiring deep thinking",
                workplaceStyle: "The deep thinker who uncovers insights others miss. Prefers thorough analysis over quick decisions and values accuracy over speed. Often consulted for complex problem-solving and strategic planning. Thrives when given time to explore ideas fully and present well-reasoned recommendations. Works best with minimal interruptions.",
                growthEdge: "May overthink decisions or delay action while seeking additional data. Can become frustrated in fast-paced environments that prioritize quick iteration over thorough analysis.",
                match: (scores) => scores["Focus"] > 70 && scores["Patience"] > 60 && scores["Structure vs Chaos"] > 50,
                score: (scores) => (scores["Focus"] + scores["Patience"] + scores["Structure vs Chaos"]) / 3
            },
            {
                name: "Empathetic Leader",
                description: "Natural leader who prioritizes team wellbeing and inclusive decision-making",
                workplaceStyle: "Leads through understanding and inspiration rather than authority. Creates psychological safety where team members feel heard and valued. Excels at identifying individual strengths and matching people to roles. Often mediates conflicts and builds consensus. Prefers servant leadership over command-and-control approaches.",
                growthEdge: "May struggle with necessary but unpopular decisions that could negatively impact individuals. Sometimes takes team conflicts or failures too personally, affecting their own wellbeing.",
                match: (scores) => scores["Empathy"] > 70 && scores["Initiative"] > 60 && scores["Social Energy"] > 60,
                score: (scores) => (scores["Empathy"] + scores["Initiative"] + scores["Social Energy"]) / 3
            },
            {
                name: "Steady Executor",
                description: "Reliable performer who maintains consistency and takes care of fundamentals",
                workplaceStyle: "The dependable foundation others build upon. Maintains high personal standards and sustainable work practices. Rarely burns out because they pace themselves well. Often becomes the institutional memory and process guardian. Prefers incremental improvement over dramatic overhauls.",
                growthEdge: "May be perceived as resistant to change or lacking urgency during critical moments. Sometimes undervalues their own contributions and avoids taking credit for successes.",
                match: (scores) => scores["Patience"] > 60 && scores["Structure vs Chaos"] > 60 && scores["Self-Maintenance"] > 60,
                score: (scores) => (scores["Patience"] + scores["Structure vs Chaos"] + scores["Self-Maintenance"]) / 3
            },
            {
                name: "Creative Maverick",
                description: "Innovative problem-solver who thrives in unstructured, experimental environments", 
                workplaceStyle: "Challenges conventional thinking and finds novel approaches to old problems. Thrives in ambiguous situations where others feel lost. Often works in bursts of intense creativity followed by reflection periods. Prefers flexible schedules and unconventional work arrangements. Best utilized for breakthrough thinking and innovation projects.",
                growthEdge: "May struggle with routine tasks or detailed follow-through on creative ideas. Can become impatient with bureaucracy or colleagues who prefer established methods.",
                match: (scores) => scores["Risk Tolerance"] > 70 && scores["Structure vs Chaos"] < 40 && scores["Focus"] > 60,
                score: (scores) => (scores["Risk Tolerance"] + (100 - scores["Structure vs Chaos"]) + scores["Focus"]) / 3
            },
            {
                name: "People-First Culture Builder",
                description: "Champions team morale and creates positive, inclusive work environments",
                workplaceStyle: "The social glue that keeps teams connected and motivated. Organizes team building activities and maintains positive energy during challenging times. Naturally networks across departments and builds informal communication channels. Often becomes the cultural ambassador for company values. Excels at onboarding and mentoring new team members.",
                growthEdge: "May prioritize team happiness over necessary performance discussions or tough feedback. Can become drained by constantly managing others' emotions and workplace dynamics.",
                match: (scores) => scores["Empathy"] > 60 && scores["Social Energy"] > 70 && scores["Stress Regulation"] > 60,
                score: (scores) => (scores["Empathy"] + scores["Social Energy"] + scores["Stress Regulation"]) / 3
            }
        ];

        // Application state
        let currentQuestion = 0;
        let responses = {};
        let showResults = false;
        let isStarted = false;
        let shuffledQuestions = [];

        // Initialize shuffled questions
        function initializeQuestions() {
            const allQuestions = [];
            behaviorData.forEach((trait, traitIndex) => {
                trait.behaviors.forEach((behavior, behaviorIndex) => {
                    allQuestions.push({
                        ...behavior,
                        trait: trait.trait,
                        traitIndex,
                        id: `${traitIndex}-${behaviorIndex}`
                    });
                });
            });

            // Shuffle questions
            for (let i = allQuestions.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [allQuestions[i], allQuestions[j]] = [allQuestions[j], allQuestions[i]];
            }
            shuffledQuestions = allQuestions.slice(0, 15);
        }

        // Create icon element
        function createIcon(iconName, className = "w-4 h-4") {
            const iconElement = document.createElement('i');
            iconElement.setAttribute('data-lucide', iconName);
            iconElement.className = className;
            return iconElement;
        }

        // Calculate scores
        function calculateScores() {
            const traitScores = {};
            const traitCounts = {};

            behaviorData.forEach(trait => {
                traitScores[trait.trait] = 0;
                traitCounts[trait.trait] = 0;
            });

            shuffledQuestions.forEach((question, index) => {
                if (responses[index] !== undefined) {
                    const score = responses[index];
                    const adjustedScore = (score - 3) * question.direction;
                    traitScores[question.trait] += adjustedScore;
                    traitCounts[question.trait]++;
                }
            });

            Object.keys(traitScores).forEach(trait => {
                if (traitCounts[trait] > 0) {
                    const avgScore = traitScores[trait] / traitCounts[trait];
                    traitScores[trait] = Math.max(0, Math.min(100, (avgScore + 2) * 25));
                }
            });

            return traitScores;
        }

        // Get work culture fit
        function getWorkCultureFit(scores) {
            const matchingProfiles = personalityProfiles.filter(profile => profile.match(scores));
            
            if (matchingProfiles.length === 0) {
                personalityProfiles.forEach(profile => {
                    if (!profile.calculatedScore) {
                        const allScoreValues = Object.values(scores);
                        profile.calculatedScore = allScoreValues.reduce((sum, score) => sum + score, 0) / allScoreValues.length;
                    }
                });
                matchingProfiles.push(personalityProfiles.reduce((best, current) => 
                    (current.calculatedScore || current.score(scores)) > (best.calculatedScore || best.score(scores)) ? current : best
                ));
            }

            matchingProfiles.forEach(profile => {
                if (!profile.calculatedScore) {
                    profile.calculatedScore = profile.score(scores);
                }
            });
            
            matchingProfiles.sort((a, b) => (b.calculatedScore || b.score(scores)) - (a.calculatedScore || a.score(scores)));
            
            const primary = matchingProfiles[0];
            let secondary = null;
            
            if (matchingProfiles.length > 1 && 
                ((primary.calculatedScore || primary.score(scores)) - (matchingProfiles[1].calculatedScore || matchingProfiles[1].score(scores))) < 15) {
                secondary = matchingProfiles[1];
            }
            
            return { primary, secondary };
        }

        // Render functions
        function renderWelcomeScreen() {
            return `
                <div class="max-w-md mx-auto pt-12 fade-in">
                    <div class="text-center mb-8">
                        <div class="w-20 h-20 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full mx-auto mb-4 flex items-center justify-center">
                            <i data-lucide="brain" class="w-10 h-10 text-white"></i>
                        </div>
                        <h1 class="text-3xl font-bold text-gray-900 mb-2">
                            Workplace Personality Assessment
                        </h1>
                        <p class="text-gray-600 leading-relaxed">
                            Discover your unique personality traits and find your ideal work culture fit through behavioral insights.
                        </p>
                    </div>

                    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                        <h2 class="text-lg font-semibold text-gray-900 mb-3">What You'll Discover:</h2>
                        <div class="space-y-3 text-sm text-gray-600">
                            <div class="flex items-start gap-2">
                                <i data-lucide="check-circle" class="w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"></i>
                                <span>Your scores across 10 key personality traits</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i data-lucide="check-circle" class="w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"></i>
                                <span>Personalized work culture recommendations</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i data-lucide="check-circle" class="w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"></i>
                                <span>Insights based on micro-behavioral patterns</span>
                            </div>
                        </div>
                    </div>

                    <button onclick="startAssessment()" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-4 px-6 rounded-xl font-semibold text-lg shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5">
                        Start Assessment
                    </button>

                    <p class="text-xs text-gray-500 text-center mt-4">
                        Takes about 3-5 minutes â€¢ 15 questions
                    </p>
                </div>
            `;
        }

        function renderQuestion() {
            const progress = ((currentQuestion + 1) / shuffledQuestions.length) * 100;
            const currentQ = shuffledQuestions[currentQuestion];

            return `
                <div class="max-w-md mx-auto pt-8 fade-in">
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-medium text-gray-700">
                                Question ${currentQuestion + 1} of ${shuffledQuestions.length}
                            </span>
                            <span class="text-sm text-gray-500">
                                ${Math.round(progress)}%
                            </span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-gradient-to-r from-indigo-600 to-purple-600 h-2 rounded-full progress-bar" style="width: ${progress}%"></div>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                        <p class="text-lg font-medium text-gray-900 leading-relaxed">
                            ${currentQ.statement}
                        </p>
                    </div>

                    <div class="space-y-3">
                        ${[
                            { value: 5, label: "Strongly Agree", color: "from-green-600 to-green-700" },
                            { value: 4, label: "Agree", color: "from-green-500 to-green-600" },
                            { value: 3, label: "Neutral", color: "from-gray-500 to-gray-600" },
                            { value: 2, label: "Disagree", color: "from-red-500 to-red-600" },
                            { value: 1, label: "Strongly Disagree", color: "from-red-600 to-red-700" }
                        ].map(option => `
                            <button onclick="handleResponse(${option.value})" class="w-full bg-gradient-to-r ${option.color} text-white py-4 px-6 rounded-xl font-medium shadow-md hover:shadow-lg transition-all duration-200 transform hover:-translate-y-0.5 active:translate-y-0">
                                ${option.label}
                            </button>
                        `).join('')}
                    </div>

                    <div class="text-center mt-6">
                        <p class="text-xs text-gray-500">
                            Tap your response to continue
                        </p>
                    </div>
                </div>
            `;
        }

        function renderResults() {
            const scores = calculateScores();
            const workCultureFit = getWorkCultureFit(scores);

            return `
                <div class="max-w-md mx-auto pt-8 fade-in">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-teal-600 rounded-full mx-auto mb-3 flex items-center justify-center">
                            <i data-lucide="check-circle" class="w-8 h-8 text-white"></i>
                        </div>
                        <h1 class="text-2xl font-bold text-gray-900">Your Results</h1>
                    </div>

                    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                        <h2 class="text-xl font-bold text-gray-900 mb-2">
                            ${workCultureFit.primary.name}
                        </h2>
                        <p class="text-gray-600 text-sm mb-4">
                            ${workCultureFit.primary.description}
                        </p>
                        <div class="bg-gray-50 rounded-lg p-4 mb-3">
                            <h3 class="font-semibold text-gray-900 text-sm mb-2">Workplace Style:</h3>
                            <p class="text-gray-700 text-xs leading-relaxed">
                                ${workCultureFit.primary.workplaceStyle}
                            </p>
                        </div>
                        <div class="bg-amber-50 rounded-lg p-4">
                            <h3 class="font-semibold text-amber-900 text-sm mb-2">Growth Edge:</h3>
                            <p class="text-amber-800 text-xs leading-relaxed">
                                ${workCultureFit.primary.growthEdge}
                            </p>
                        </div>
                        ${workCultureFit.secondary ? `
                            <div class="mt-4 pt-4 border-t border-gray-200">
                                <h3 class="font-semibold text-gray-900 text-sm mb-1">
                                    Secondary Trait: ${workCultureFit.secondary.name}
                                </h3>
                                <p class="text-gray-600 text-xs">
                                    ${workCultureFit.secondary.description}
                                </p>
                            </div>
                        ` : ''}
                    </div>

                    <div class="space-y-3 mb-6">
                        ${behaviorData.map(trait => {
                            const score = scores[trait.trait] || 0;
                            return `
                                <div class="bg-white rounded-lg shadow-md p-4">
                                    <div class="flex items-center justify-between mb-2">
                                        <div class="flex items-center gap-2">
                                            <div class="w-8 h-8 ${trait.color} rounded-lg flex items-center justify-center">
                                                <i data-lucide="${trait.icon}" class="w-4 h-4 text-white"></i>
                                            </div>
                                            <span class="font-medium text-gray-900 text-sm tooltip">
                                                 ${trait.trait === "Structure vs Chaos" ? "Structure Preference" : trait.trait}
                                                 <span class="tooltiptext">${traitDefinitions[trait.trait === "Structure vs Chaos" ? "Structure Preference" : trait.trait]}</span>
                                            </span>
                                        </div>
                                        <span class="text-sm font-semibold text-gray-700">
                                            ${Math.round(score)}%
                                        </span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="${trait.color} h-2 rounded-full score-bar" style="width: ${score}%"></div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>

                    <button onclick="resetAssessment()" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 px-6 rounded-xl font-semibold flex items-center justify-center gap-2 shadow-lg hover:shadow-xl transition-all duration-300">
                        <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
                        Take Assessment Again
                    </button>
                </div>
            `;
        }

        // Event handlers
        function startAssessment() {
            isStarted = true;
            initializeQuestions();
            render();
        }

        function handleResponse(value) {
            responses[currentQuestion] = value;
            
            if (currentQuestion < shuffledQuestions.length - 1) {
                setTimeout(() => {
                    currentQuestion++;
                    render();
                }, 200);
            } else {
                setTimeout(() => {
                    showResults = true;
                    render();
                }, 500);
            }
        }

        function resetAssessment() {
            currentQuestion = 0;
            responses = {};
            showResults = false;
            isStarted = false;
            shuffledQuestions = [];
            render();
        }

        // Main render function
        function render() {
            const app = document.getElementById('app');
            
            if (!isStarted) {
                app.innerHTML = renderWelcomeScreen();
            } else if (showResults) {
                app.innerHTML = renderResults();
            } else {
                app.innerHTML = renderQuestion();
            }
            
            // Re-initialize Lucide icons
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Wait a bit for CDNs to load
            setTimeout(() => {
                render();
            }, 100);
        });

        // Also initialize when window fully loads as backup
        window.addEventListener('load', function() {
            if (!document.getElementById('app').innerHTML) {
                render();
            }
        });
    </script>
</body>
</html>
